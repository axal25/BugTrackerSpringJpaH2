DROP SCHEMA IF EXISTS SCRIPT_SCHEMA CASCADE;
CREATE SCHEMA IF NOT EXISTS SCRIPT_SCHEMA;

CREATE TABLE IF NOT EXISTS SCRIPT_SCHEMA.APPLICATIONS(
  APPLICATION_ID NUMBER GENERATED BY DEFAULT AS IDENTITY,
  APP_NAME VARCHAR2(50) NOT NULL,
  DESCRIPTION VARCHAR2(250),
  OWNER VARCHAR2(50),
  PRIMARY KEY(APPLICATION_ID)
);

CREATE TABLE IF NOT EXISTS SCRIPT_SCHEMA.RELEASES(
   ID NUMBER GENERATED BY DEFAULT AS IDENTITY,
   RELEASE_DATE TIMESTAMP,
   DESCRIPTION VARCHAR2(250),
   PRIMARY KEY(ID)
);

CREATE TABLE IF NOT EXISTS SCRIPT_SCHEMA.RELEASES_APPLICATION(
    RELEASE_ENTITY_ID NUMBER NOT NULL,
    APPLICATIONS_APPLICATION_ID NUMBER NOT NULL,
    PRIMARY KEY(RELEASE_ENTITY_ID, APPLICATIONS_APPLICATION_ID),
    FOREIGN KEY(RELEASE_ENTITY_ID) REFERENCES SCRIPT_SCHEMA.RELEASES(ID),
    FOREIGN KEY(APPLICATIONS_APPLICATION_ID) REFERENCES SCRIPT_SCHEMA.APPLICATIONS(APPLICATION_ID)
);

CREATE TABLE IF NOT EXISTS SCRIPT_SCHEMA.TICKETS(
   ID NUMBER GENERATED BY DEFAULT AS IDENTITY,
   TITLE VARCHAR2(50),
   STATUS VARCHAR2(25),
   DESCRIPTION VARCHAR2(250),
   APPLICATION_ID NUMBER,
   PRIMARY KEY(ID)
);

CREATE TABLE IF NOT EXISTS SCRIPT_SCHEMA.TICKET_RELEASE(
    RELEASE_FK NUMBER NOT NULL,
    TICKET_FK NUMBER NOT NULL,
    PRIMARY KEY(RELEASE_FK, TICKET_FK),
    FOREIGN KEY(RELEASE_FK) REFERENCES SCRIPT_SCHEMA.RELEASES(ID),
    FOREIGN KEY(TICKET_FK) REFERENCES SCRIPT_SCHEMA.TICKETS(ID)
);
